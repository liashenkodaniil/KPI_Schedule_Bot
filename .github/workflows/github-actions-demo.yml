name: Build and Release Application
run-name: üöÄ Build & Release triggered by ${{ github.actor }}

# –¢—Ä–∏–≥–µ—Ä–∏: –ü—É—à —É –≥—ñ–ª–∫—É main –∞–±–æ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–µ–≥—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, v1.0.0)
on:
  push:
    branches: [ "main" ]
    tags:
      - 'v*' # –°–ø—Ä–∞—Ü—å–æ–≤—É—î, —è–∫—â–æ —Ç–µ–≥ –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ 'v'

permissions:
  contents: write # –ù–µ–æ–±—Ö—ñ–¥–Ω–æ –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ä–µ–ª—ñ–∑—É

jobs:
  build:
    name: üèóÔ∏è Build Application
    runs-on: ubuntu-latest
    steps:
      - name: üì• Checkout code
        uses: actions/checkout@v4

      - name: üë§ Display Author Info
        run: |
          echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"
          echo "üë§ –ê–≤—Ç–æ—Ä –∑–º—ñ–Ω: ${{ github.actor }}"
          echo "üìß –ü–æ–¥—ñ—è: ${{ github.event_name }}"
          echo "üåø –ì—ñ–ª–∫–∞/–¢–µ–≥: ${{ github.ref }}"
          echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"

      # --- –¢–£–¢ –ú–ê–Ñ –ë–£–¢–ò –í–ê–®–ê –ö–û–ú–ê–ù–î–ê –ó–ë–Ü–†–ö–ò ---
      # –ü—Ä–∏–∫–ª–∞–¥ –¥–ª—è Node.js: npm install && npm run build
      # –ü—Ä–∏–∫–ª–∞–¥ –¥–ª—è Go: go build -o myapp main.go
      # –î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—ó –º–∏ —Å—Ç–≤–æ—Ä–∏–º–æ —Ç–µ–∫—Å—Ç–æ–≤–∏–π —Ñ–∞–π–ª —ñ –∑–∞–ø–∞–∫—É—î–º–æ –π–æ–≥–æ
      - name: üî® Build process (Simulation)
        run: |
          mkdir build_output
          echo "Build date: $(date)" > build_output/info.txt
          echo "Built by: ${{ github.actor }}" >> build_output/info.txt
          # –°—Ç–≤–æ—Ä—é—î–º–æ –∞—Ä—Ö—ñ–≤ (—É–º–æ–≤–Ω–∏–π "–¥–æ–¥–∞—Ç–æ–∫")
          zip -r my-app-release.zip build_output/

      - name: üì§ Upload Build Artifact
        uses: actions/upload-artifact@v4
        with:
          name: built-app
          path: my-app-release.zip
          retention-days: 1

  release:
    name: üì¶ Publish GitHub Release
    needs: build # –ß–µ–∫–∞—î–º–æ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –∑–±—ñ—Ä–∫–∏
    if: startsWith(github.ref, 'refs/tags/') # –í–∏–∫–æ–Ω—É–≤–∞—Ç–∏ —Ç—ñ–ª—å–∫–∏ —è–∫—â–æ —Ü–µ –¢–ï–ì
    runs-on: ubuntu-latest
    steps:
      - name: üì• Download Artifact
        uses: actions/download-artifact@v4
        with:
          name: built-app

      - name: üöÄ Create Release and Upload Asset
        uses: softprops/action-gh-release@v1
        with:
          files: my-app-release.zip
          name: Release ${{ github.ref_name }}
          body: |
            –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π —Ä–µ–ª—ñ–∑ –≤—ñ–¥ ${{ github.actor }}
            –í–µ—Ä—Å—ñ—è: ${{ github.ref_name }}
          draft: false
          prerelease: false
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}